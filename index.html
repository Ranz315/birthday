<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Happy Birthday</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root {
      --bg: #f7e9f0;
      --cake: #ffd6e8;
      --icing: #fff1f8;
      --candle: #cdb4db;
      --flame: #ffb703;
      --text: #6d597a;
    }

    * {
      box-sizing: border-box;
      font-family: 'Poppins', system-ui, sans-serif;
    }

    body {
      margin: 0;
      min-height: 100vh;
      background: linear-gradient(135deg, #fde2e4, #e2ece9);
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--text);
    }

    .container {
      position: relative;
      text-align: center;
      padding: 2rem;
      background: rgba(255, 255, 255, 0.6);
      border-radius: 24px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.08);
      width: 90%;
      max-width: 500px;
      z-index: 2;
    }

    h1 {
      margin-bottom: 0.5rem;
      font-weight: 600;
    }

    .hint {
      font-size: 0.9rem;
      opacity: 0.8;
      margin-bottom: 1.5rem;
    }

    /* Cake */
    .cake {
      position: relative;
      width: 260px;
      height: 180px;
      margin: 0 auto 2rem;
      display: flex;
      align-items: flex-end;
      justify-content: center;
    }

    .cake-base {
      width: 100%;
      height: 110px;
      background: var(--cake);
      border-radius: 0 0 24px 24px;
      position: relative;
      z-index: 1;
    }

    .cake-icing {
      position: absolute;
      top: 30px;
      left: 0;
      width: 100%;
      height: 45px;
      background: var(--icing);
      border-radius: 24px 24px 16px 16px;
      z-index: 2;
    }

    /* Candles */
    .candles {
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 14px;
      z-index: 5;
    }

    .candle {
      width: 12px;
      height: 40px;
      background: var(--candle);
      border-radius: 6px;
      position: relative;
      cursor: pointer;
    }

    .flame {
      position: absolute;
      top: -16px;
      left: 50%;
      transform: translateX(-50%);
      width: 10px;
      height: 14px;
      background: radial-gradient(circle at 30% 30%, #fff, var(--flame));
      border-radius: 50% 50% 50% 50%;
      animation: flicker 0.6s infinite alternate;
    }

    @keyframes flicker {
      from { transform: translateX(-50%) scale(1); opacity: 1; }
      to { transform: translateX(-50%) scale(0.9); opacity: 0.85; }
    }

    .flame.off {
      display: none;
    }

    /* Message */
    .message {
      font-size: 2rem;
      font-weight: 700;
      margin-top: 1.5rem;
      display: none;
      animation: pop 0.6s ease forwards;
    }

    @keyframes pop {
      from { transform: scale(0.8); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }

    .confetti {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 1;
    }
  
    .next-btn {
      display: inline-block;
      margin-top: 1.5rem;
      padding: 0.6rem 1.4rem;
      background: #ffd1dc;
      color: #6d597a;
      border-radius: 20px;
      text-decoration: none;
      font-weight: 600;
      box-shadow: 0 8px 20px rgba(0,0,0,0.08);
    }

    /* Decorations */
    .sprinkle {
      position: absolute;
      width: 6px;
      height: 12px;
      border-radius: 3px;
      background: hsl(var(--h), 70%, 80%);
    }

    .cake-base::after {
      content: '';
      position: absolute;
      inset: 10px;
      border-radius: 0 0 20px 20px;
      border: 2px dashed rgba(255,255,255,0.6);
    }
  
    /* Scroll message */
    .scroll-container {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.45);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      animation: fadeIn 0.4s ease forwards;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    .scroll {
      background: linear-gradient(#fff7e6, #fff1d6);
      width: 90%;
      max-width: 650px;
      padding: 3rem 2.5rem;
      border-radius: 22px;
      box-shadow: 0 40px 80px rgba(0,0,0,0.35);
      animation: unroll 1.2s ease forwards;
      color: #6d597a;
      position: relative;
    }

    .scroll::before,
    .scroll::after {
      content: '';
      position: absolute;
      left: 0;
      width: 100%;
      height: 18px;
      background: #f1c27d;
      border-radius: 20px;
    }

    .scroll::before { top: -9px; }
    .scroll::after {

    .scroll h2 {
      text-align: center;
      margin-bottom: 1.2rem;
    }

    .scroll p {
      line-height: 1.8;
      white-space: pre-line;
    }

    @keyframes unroll {
      from { transform: scaleY(0.2); opacity: 0; }
      to { transform: scaleY(1); opacity: 1; }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Make a Wish ðŸŽ‚</h1>
    <div class="hint">Click the flames to blow out the candles</div>

    <div class="cake">
      <div class="candles" id="candles"></div>
      <div class="cake-icing"></div>
      <div class="cake-base"></div>
    </div>

    <div class="message" id="message">Happy Birthday Sai ðŸŽ‰</div>
    <button class="next-btn" id="nextBtn" style="display:none;">Open your message ðŸ’Œ</button>
  </div>

  <div class="scroll-container" id="scrollContainer" style="display:none;">
      <div class="scroll">
        <h2>Happy Birthday Sai ðŸ’›</h2>
        <p>
Happy Birthday Sai !! You're 22 now.

I'm so proud of you. I know I tell this to you every birthday but you genuinely keep surprising me. You're the most hardworking person I've ever seen and you deserve every good thing coming your way.

You're always in my prayers and I hope you get everything you ever wanted this year.

I know going to a new city all alone trying to make a living for yourself is hard, but honestly you're killing it!!! You somehow make it work, doesn't matter what life throws at you.

I'm so proud of the man you've become and the man you are becoming.

Happy 22!
        </p>
      </div>
    </div>

    <canvas class="confetti" id="confetti"></canvas>

  <script>
    const candleCount = 5;
    const candlesEl = document.getElementById('candles');
    const messageEl = document.getElementById('message');

    let flames = [];
    let flamesLeft = candleCount;

    // Create candles
    for (let i = 0; i < candleCount; i++) {
      const candle = document.createElement('div');
      candle.className = 'candle';

      const flame = document.createElement('div');
      flame.className = 'flame';

      candle.appendChild(flame);
      candlesEl.appendChild(candle);
      flames.push(flame);
    }

    /* Microphone blow detection */
    let audioContext, analyser, microphone, dataArray;

    async function initMic() {
      audioContext = new (window.AudioContext || window.webkitAudioContext)();
      const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
      microphone = audioContext.createMediaStreamSource(stream);
      analyser = audioContext.createAnalyser();
      analyser.fftSize = 256;
      dataArray = new Uint8Array(analyser.frequencyBinCount);
      microphone.connect(analyser);
      listenForBlow();
    }

    function listenForBlow() {
      analyser.getByteFrequencyData(dataArray);
      const volume = dataArray.reduce((a, b) => a + b) / dataArray.length;

      if (volume > 45 && flamesLeft > 0) {
        blowOutOne();
      }
      requestAnimationFrame(listenForBlow);
    }

    function blowOutOne() {
      for (let flame of flames) {
        if (!flame.classList.contains('off')) {
          flame.classList.add('off');
          flamesLeft--;
          break;
        }
      }
      if (flamesLeft === 0) celebrate();
    }

    /* Celebration */
    function celebrate() {
      messageEl.style.display = 'block';
      document.getElementById('nextBtn').style.display = 'inline-block';
      startConfetti();
    }

    document.getElementById('nextBtn').addEventListener('click', () => {
      document.getElementById('scrollContainer').style.display = 'flex';
    });

    /* Confetti */
    const canvas = document.getElementById('confetti');
    const ctx = canvas.getContext('2d');
    let confettiPieces = [];

    function resize() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }
    window.addEventListener('resize', resize);
    resize();

    function startConfetti() {
      confettiPieces = Array.from({ length: 150 }, () => ({
        x: Math.random() * canvas.width,
        y: Math.random() * canvas.height - canvas.height,
        r: Math.random() * 6 + 3,
        d: Math.random() * 1 + 0.5,
        color: `hsl(${Math.random() * 360}, 70%, 80%)`
      }));
      requestAnimationFrame(updateConfetti);
    }

    function updateConfetti() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      confettiPieces.forEach(p => {
        ctx.beginPath();
        ctx.fillStyle = p.color;
        ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
        ctx.fill();
        p.y += p.d * 4;
        if (p.y > canvas.height) p.y = -10;
      });
      requestAnimationFrame(updateConfetti);
    }

    // Start mic on user interaction
    document.body.addEventListener('click', initMic, { once: true });
  </script>
</body>
</html>